package com.yeadun;import com.lion.testutil.product.ProductType;import com.lion.testutil.product.Response;import com.lion.testutil.product.ProductWorker;import com.lion.testutil.Config;import com.lion.testutil.product.model.NullPOJO;import com.lion.testutil.product.model.P100028;import com.lion.testutil.util.excel.ExcelWorker;import com.lion.testutil.util.net.HttpClientFactory;import org.apache.http.client.config.RequestConfig;import org.apache.http.message.BasicHeader;import org.junit.Test;import java.util.HashMap;public class TestDemo {    @Test    @SuppressWarnings("unchecked")    public void test() throws Exception {        String builderName = "MyBuilder";        /**         * 获取ClosableHttpClient对象         * */        // 构建HttpClientFactory工厂        HttpClientFactory factory = HttpClientFactory.getFactory();        // 设置Client 请求参数。主要设置超时        RequestConfig config = RequestConfig.custom()                .setConnectTimeout(Config.CONNECT_TIMEOUT)                .setConnectionRequestTimeout(1000)                .setSocketTimeout(5000)                .build();        // 创建并获取需要使用的HttpClientBuilder，并进行属性设置        // 使用获取的HttpClientBuilder创建ClosableHttpClient对象        // 该Builder构建出的HttpClient对象属性都一样，但是是不同实例        factory.createBuilder(builderName);        factory.getBuilder(builderName).setDefaultRequestConfig(config);        HttpClientFactory._HttpClient client = factory.createHttpClient(builderName, Config.PROD_URL);        /**         * 请求头配置         * */        client.addHeader(new BasicHeader("Content-Type", "application/x-www-form-urlencoded"))                .addHeader(new BasicHeader("charset", "UTF-8"))                .addHeader(new BasicHeader("Accept-Charset", "UTF-8"));        /**         * 获取ExcelWork对象，并传入BasicFunction接口实现类，对读取到的每行数据进行处理。         * */        ExcelWorker<Response> worker = new ExcelWorker<>("/Users/very/文档/招财猫测试数据.xlsx");        ProductWorker product = new ProductWorker(ProductType.P100028, client, Config.MER_CODE, Config.PROD_KEY);        int[] colNum = {1, 2, 3, 4};//        int[] rowNum = {10};        String sheetName = "Sheet2";        HashMap<Integer, Response> _28Result = worker.execute(sheetName, null, colNum, product);        // 打印结果        System.out.println("-----------  ProductWorker --------------");        for (Integer num : _28Result.keySet()) {            Response response = _28Result.get(num);            System.out.println("No.[" + num + "]: MerchPrivate => "                    + response.getMerchPrivate() + ", OrderId => "                    + response.getOrderId() + ", RetCode => "                    + response.getRetCode() + "RetDesc => "                    + response.getRetDesc() + "RetInfo => "                    + response.getRetInfo() + " ProductWorker => "                    + response.getPOJOData(ProductType.P100028).toString());            Object obj = response.getPOJOData(ProductType.P100028);            if(obj instanceof NullPOJO){                NullPOJO nullPOJO = (NullPOJO)response.getPOJOData(ProductType.P100028);                System.out.println(nullPOJO.toString());            }else{                P100028 p100028 = (P100028)response.getPOJOData(ProductType.P100028);                System.out.println(p100028.getMobile_fraud());            }        }    }}